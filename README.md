# Rust Copartner

Rust Copartner is a tool for suggesting changes to a Rust project.

## Usage

Execute the following command to ask suggestions:

```bash
python copartner.py -p <project_dir> -d <last_change_diff_file>
```

## Example

### Scene 1

> You can find an example in the `e2e_tests/scene1` directory.

Source code of `main.rs` before the last change:

```rust
#[derive(Debug, Clone, Copy, PartialEq)]
struct Point {
    x: i32,
    y: i32,
}

impl Point {
    fn new(x: i32, y: i32) -> Self {
        Self { x, y }
    }
}

fn main() {
    let p = Point::new(1, 2);
    println!("p = {:?}", p);
}

```

The `last_change.diff` (Generated by other tools):

```diff
--- a/main.rs
+++ b/main.rs
@@ -1,5 +1,5 @@
 #[derive(Debug, Clone, Copy, PartialEq)]
-struct Point {
+struct Point3D {
     x: i32,
     y: i32,
 }

```

Execute the following command to ask suggestions:

```bash
python copartner.py -p <PROJECT_DIR> -d last_change.diff
```

Output the suggested change and ask if you want to accept it.

```diff
Suggest change:
--- a/main.rs
+++ b/main.rs
@@ -1,16 +1,17 @@
 #[derive(Debug, Clone, Copy, PartialEq)]
-struct Point {
+struct Point3D {
     x: i32,
     y: i32,
+    z: i32,
 }
 
-impl Point {
-    fn new(x: i32, y: i32) -> Self {
-        Self { x, y }
+impl Point3D {
+    fn new(x: i32, y: i32, z: i32) -> Self {
+        Self { x, y, z }
     }
 }
 
 fn main() {
-    let p = Point::new(1, 2);
+    let p = Point3D::new(1, 2, 3);
     println!("p = {:?}", p);
 }

Accept? (y/n): y
```

When you accept the suggestion, the `main.rs` file will be updated to the following:

```rust
#[derive(Debug, Clone, Copy, PartialEq)]
struct Point3D {
    x: i32,
    y: i32,
    z: i32,
}

impl Point3D {
    fn new(x: i32, y: i32, z: i32) -> Self {
        Self { x, y, z }
    }
}

fn main() {
    let p = Point3D::new(1, 2, 3);
    println!("p = {:?}", p);
}

```
